# TC24166: Account Activation and Login

**Azure Test Case ID:** 24166  
**Suite:** Login-25146  
**Category:** âœ… Pure-UI-Appropriate  
**Infrastructure Required:** Activation token generation utility

---

## Source Analysis

**Azure Test Case:**
- Step 1: "User is able to activate a new account, assign permissions and login successfully where IsEmailRequired = true"
- Step 2: "Check the translated content in French"
- Vague, no detailed steps

**Cypress Implementation:**
- File: `cypress/e2e/UserJourney/UserActivation.cy.js`
- Two-part test suite:

**Part 1: User Invite Journey (Admin UI)**
1. Create user via Admin > Staff Members
2. Check status "Not-Invited"
3. Assign permissions
4. Send activation email (button click)
5. Check status "Invited"
6. Check email received (Gmail API integration)
7. Re-send activation email
8. Check status "Re-invited"

**Part 2: Account Activation Journey**
1. Parse JWT token from email (validate 24hr expiry)
2. Navigate to activation link
3. Fill password on activation page
4. Submit activation
5. Login with new credentials
6. Verify setup completed
7. Delete user via API

**Issues:**
- Tests multiple areas: Admin (user creation), Permissions (assignment), Email (delivery), Login (activation)
- Email dependency (Gmail API integration)
- Mix of Pure UI and non-UI concerns

---

## Final Test Specification

### What This Test Verifies
User can activate account using activation link and login for the first time.

### Prerequisites

**Seeded user in "Invited" status:**
- Username: "activation.test@activeops.com"
- Email: "activation.test@activeops.com"
- Status: Invited (not yet activated)
- Permissions: Assigned
- Pre-generated activation token: [generated by utility]

**Infrastructure:**
- Activation token generation utility (creates valid tokens for seeded users per environment)

### Test Steps

**Part 1: Activation Page with Valid Token**
1. Navigate to `/activateaccount/{seededToken}`
2. Verify: Activation form displays
   - Username pre-filled correctly
   - New Password field
   - Confirm New Password field
   - Submit button
3. Enter valid password (meets requirements)
4. Confirm password
5. Click Submit
6. Verify: Success message "Your account has been activated successfully"
7. Click "Go to Login Screen"

**Part 2: First Login After Activation**
1. Enter activated username
2. Enter password set during activation
3. Click Login
4. Verify: Login successful, dashboard loads

**Part 3: Activation with Invalid Token (Optional)**
1. Navigate to `/activateaccount/{expiredOrInvalidToken}`
2. Verify: Error message shown
3. Verify: Cannot proceed with activation

### Expected Results
- Activation form works with valid token
- Password validation enforced
- Account activated successfully
- First login works with new credentials
- Invalid/expired tokens show errors

### Automation Approach
- **Pattern:** Pattern A (workflow test)
- **Page Objects:** ActivationPage, LoginPage, DashboardPage
- **Locators:**
  - Username (read-only): GetByLabel or input with username attribute
  - Password fields: GetByLabel "New Password", "Confirm New Password"
  - Submit: GetByRole Button "Submit"
  - Success message: GetByText or by role Alert
- **Token:** Utility generates valid activation token for seeded user before test runs

---

## Notes
- Requires activation token generation utility (Phase 1 infrastructure task)
- Email delivery NOT tested (email system concern, not Pure UI)
- French translation ignored (not implemented in Cypress)
- Suite placement: Stays in Login suite as it's first-time login related
- Related: TC25061, TC29201, TC29202 use similar token utilities for reset workflows
